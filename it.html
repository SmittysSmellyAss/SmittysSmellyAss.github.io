<!DOCTYPE html>
<html>
<body>

<!-- Embed Twitch video player in your HTML page -->
<div id="twitch-embed"></div>

<script src="https://embed.twitch.tv/embed/v1.js"></script>

<script>
// Fetch live streams data from Twitch API 
fetch('https://api.twitch.tv/helix/streams?game_id=32399', {
    headers: {
        'Client-ID': 'y8wxyw19ctwnw51yuvr15vf136t3q3',
        'Authorization': 'Bearer uhbn35bj6cn1dw8y7gynw3q28nxu2e'
    }
})
.then(response => {
    if (!response.ok) {
        throw new Error('Network response was not ok');
    }
    return response.json();
})
.then(data => {
    let streams = data.data;
    
    // Filter out streams with 10 or more viewers
    let smallStreams = streams.filter(stream => stream.viewer_count < 10);

    if (smallStreams.length > 0) {
        // Select a random stream 
        let randomStream = smallStreams[Math.floor(Math.random() * smallStreams.length)];

        // Create a new Twitch.Embed object that will render within the "twitch-embed" root element.
        new Twitch.Embed("twitch-embed", {
            width: 854,
            height: 480,
            channel: randomStream.user_name,
            layout: "video",
            autoplay: true,
        });
    }
})
.catch(error => console.error('Error:', error));
</script>

</body>
</html>
